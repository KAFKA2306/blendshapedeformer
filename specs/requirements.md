# requirements.md（ドラフト）

> 本ドキュメントは「VRChat BlendShape Auto-Generator powered by MLDeformer」プロジェクトの **WHY/WHAT** を網羅的に示します。**HOW**（設計）や **WHEN/WHO**（タスク）は別ファイルで定義します。

## 1. プロダクトビジョン

- VRChatアバターのViseme/表情ブレンドシェイプを **“ワンクリック・数分”** で自動生成できるAIワークフローを提供し、  
  クリエイターの制作工数・技能格差を解消する。

## 2. ステークホルダー

| 役割 | 期待価値 |
| --- | --- |
| 3Dクリエイター (初心者～上級) | 制作時間90％削減・品質均一化 |
| VTuber事務所/プロダクション | キャラクター量産時のコスト圧縮 |
| VRChatユーザー | 表情表現の多様化・体験向上 |
| 開発チーム | 再現性高いML基盤＋運用容易なシステム |

## 3. ユースケース（主要シナリオ）

1. Blenderでアバターメッシュを読み込み、GUIボタンでViseme＋感情キーを自動生成。
2. UnityへFBXをインポートし、専用ウィザードでVisemeマッピングとFX Animatorを自動設定。
3. VRChat SDK3アップロードテストが全自動で通過し、最適化警告なしでアップロード完了。

## 4. 機能要件

| カテゴリ | 要件ID | 要件 |
| --- | --- | --- |
| 生成 | F-01 | VRChat標準Viseme15種を自動生成できること |
| 生成 | F-02 | 表情キー5種（Angry/Fun/Joy/Sorrow/Surprised）を自動生成できること |
| 生成 | F-03 | ユーザーが任意強度(0-1.0)で生成を指示可能 |
| 生成 | F-04 | 生成後に自動品質チェック＆異常頂点クランプを行う |
| 統合 | F-05 | Unityエディタ内でAvatar Descriptor設定・Visemeマッピングを自動で行う |
| 統合 | F-06 | FXレイヤーAnimatorとパラメータを自動生成する |
| 汎化 | F-07 | トポロジ非依存（異なるメッシュ構造）で平均頂点誤差≤5 mmを維持 |
| UI/UX | F-08 | Blender/Unity両方でステップバイステップGUIを提供 |
| 更新 | F-09 | 自動アップデート機構とロールバック手順を備える |
| 拡張 | F-10 | 新アバターへの転移学習を10-50サンプル/6 h以内で完了できる |

## 5. 非機能要件

| 指標 | 目標値 |
| --- | --- |
| 単一Viseme推論時間 | ≤3 s（RTX 3060 8 GB環境） |
| メモリ使用量 | GPU≤2 GB / RAM≤4 GB |
| 対応OS | Windows10/11, macOS12+, Ubuntu20.04+ |
| Blender対応 | 3.0以上 |
| Unity対応 | 2019.4LTS / 2022.3LTS（SDK3互換） |
| VRChat推奨ポリゴン数 | 70,000以下 (Good) |
| エラー率 | 生成ブレンドシェイプ破綻率≤2% |
| 可用性 | 99%（月間計画停止除く） |
| セキュリティ | 署名付きモデル配布・サンドボックス推論 |

## 6. 受け入れ基準

- [ ] F-01～F-10すべての要件を満たすデモを録画提出。
- [ ] Phase 1完了時に **「推論≤3 s」「平均頂点誤差≤5 mm」** をCI自動ベンチで達成。
- [ ] SDK3アップロードワークフローで警告0件。
- [ ] macOS環境でCPUフォールバック動作確認済み。
- [ ] ライセンス/再配布ポリシー策定し、法務レビュー完了。

## 7. 制約条件

- CUDA最適化は任意。非CUDA環境でも機能限定なく動作させる。
- 商用利用を想定し、学習データは著作権クリア済みサンプルのみ使用。
- トレーニングコードは社内専用、推論エンジンのみ配布。

## 8. リスク一覧（開発視点）

| リスク | 影響 | 優先度 | 軽減策 |
| --- | --- | --- | --- |
| VRChat SDK API変更 | 統合機能停止 | 高 | Adapter層＋週次β版CI |
| CUDA依存 | macユーザー排除 | 高 | Metal/CPUパス実装 |
| 学習データ権利 | 法的問題 | 中 | 権利確認＆契約書保管 |
| メッシュ多様性不足 | 精度低下 | 中 | 10+体型データ継続収集 |

## 9. 今後の拡張要求（参考）

- VRMフォーマット対応
- 全身リギング自動化
- SaaSクラウド版（GPUオンデマンド推論）
